import{_ as Ye,e as is,a as us,b as ds,c as ps,d as ms}from"./DialogTitle.vue_vue_type_script_setup_true_lang-A_FWc9qh.js";import{a as _s,_ as fs}from"./BaseSearch.vue_vue_type_script_setup_true_lang-0Tf5Locx.js";import{_ as vs}from"./Input.vue_vue_type_script_setup_true_lang-7CPGRph2.js";import{d as H,o,a as $,w as n,r as te,m as de,u as e,f as he,aa as hs,c as W,N as ys,i as u,v as Je,x as fe,A as v,z as je,ab as j,a8 as Ke,D as s,F as M,E as ie,e as t,n as L,C as p,ac as ke,J as _,B as h,K as ue,I as X,ad as ws,L as ve,M as ce,S as Le,O as gs,P as bs,ae as xs,af as ks,ag as Cs,ah as $s,ai as Is,aj as Ds,ak as Rs,al as Ms,a7 as Bs,y as me,a5 as be,am as Ss,an as As,ao as qs,H as _e,ap as Ne,aq as Te,ar as He,as as Vs,at as zs,au as Es,G as xe,av as Oe,aw as F,R as Us,ax as Fs,_ as js}from"./index-N0gcJoKJ.js";import{_ as Ns}from"./ChatBox.vue_vue_type_script_setup_true_lang-5Xo_N8dc.js";import{_ as Ts}from"./ScrollArea.vue_vue_type_script_setup_true_lang-HlncvtC-.js";const Hs=H({__name:"ToastAction",props:{altText:{},asChild:{type:Boolean},as:{},class:{}},setup(y){const c=y;return(m,D)=>(o(),$(e(hs),de(c,{class:e(he)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",c.class)}),{default:n(()=>[te(m.$slots,"default")]),_:3},16,["class"]))}});/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=W("CheckCircle2Icon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=W("ForwardIcon",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=W("HelpCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=W("MessageCircleOffIcon",[["path",{d:"M20.5 14.9A9 9 0 0 0 9.1 3.5",key:"1iebmn"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.6 5.6C3 8.3 2.2 12.5 4 16l-2 6 6-2c3.4 1.8 7.6 1.1 10.3-1.7",key:"1ov8ce"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=W("MoreVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=W("ReplyIcon",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=W("StarIcon",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=W("XCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Xs={},Gs={class:"text-highlight italic"};function Qs(y,c){return o(),u("span",Gs,[te(y.$slots,"default")])}const We=ys(Xs,[["render",Qs]]),Zs={class:"py-3"},et=s("p",{class:"text-sm text-center text-muted-foreground"}," this channel is closed ",-1),st={key:0},tt={class:"border px-4 py-3 rounded-md mt-6 space-y-3 w-4/5 mx-auto"},ot={class:"flex items-center gap-3 min-h-10"},at={class:"flex items-center gap-1"},nt={class:"text-muted-foreground"},rt={key:0,class:"bg-secondary p-3 rounded-md space-y-1"},lt={class:"text-muted-foreground"},ct={key:0,class:"border px-4 py-3 rounded-md w-4/5 mx-auto mt-3"},it={key:0,class:"text-destructive"},ut={class:"flex items-center gap-3"},dt={class:"flex items-center gap-1"},pt=["onClick"],mt={class:"mt-1"},_t={class:"w-1/2 space-y-3"},ft={key:0,class:"text-destructive"},vt={key:1,class:"text-destructive"},ht=H({__name:"ChatReview",props:{escrowId:{}},async setup(y){let c,m;const D=y,O=Je(),g=([c,m]=fe(()=>O.getReviewFactory()),c=await c,m(),c),x=v(),P=v(0),q=v(""),Y=v(!1),V=v(!1);je(q,d=>{d.length>=5&&(V.value=!1)});async function G(){if(Y.value=!1,V.value=!1,P.value<1||P.value>5){Y.value=!0;return}if(q.value.length<5){V.value=!0;return}const f=await(await g.createReview(D.escrowId,P.value,q.value)).wait();(f==null?void 0:f.status)===1&&await K()}const B=v(),J=v(""),S=v(!1),oe=v(!1);je(J,d=>{d.length>=5&&(S.value=!1)});async function r(){if(!x.value)return;if(S.value=!1,J.value.length<5){S.value=!0;return}const f=await(await g.createResponse(x.value.id,J.value)).wait();(f==null?void 0:f.status)===1&&await K()}function k(d){P.value=d,Y.value=!1}const z=v(j),N=v(j);async function K(){try{const d=await g.getReviewByEscrowId(D.escrowId);if(d[2]===j||d[3]===j)return;x.value={timestamp:Number(d[0]),rating:Number(d[1]),reviewingAddress:d[2],beingReviewedAddress:d[3],reviewComment:d[4],relevantEscrowId:Number(d[5]),responded:d[6],id:Number(d[7])},z.value=(await ve(x.value.reviewingAddress)).userName,N.value=(await ve(x.value.beingReviewedAddress)).userName;const f=await g.getResponse(x.value.id);if(f[1]===j)return;B.value={timestamp:Number(f[0]),responder:f[1],responseComment:f[2]}}catch{}}return Ke(K),(d,f)=>{const E=ce,pe=We,ae=Ye;return o(),u("div",Zs,[et,e(x)?(o(),u("div",st,[s("div",tt,[s("div",ot,[s("ul",at,[(o(),u(M,null,ie(5,w=>s("li",{key:w},[t(e(Pe),{class:L({"fill-primary":w<=e(x).rating}),"stroke-width":"1.25"},null,8,["class"])])),64))]),s("p",nt,p(("useDateFormat"in d?d.useDateFormat:e(ke))(e(x).timestamp,"HH:mm DD.MM.YYYY").value),1),e(N)===e(O).user.userName&&!e(B)?(o(),$(E,{key:0,size:"icon",class:"ml-auto",variant:"ghost",onClick:f[0]||(f[0]=w=>oe.value=!e(oe))},{default:n(()=>[t(e(Ls))]),_:1})):_("",!0)]),s("p",null,[t(pe,null,{default:n(()=>[h(p(e(z))+": ",1)]),_:1}),h(" "+p(e(x).reviewComment),1)]),e(B)?(o(),u("div",rt,[s("p",lt,p(("useDateFormat"in d?d.useDateFormat:e(ke))(e(B).timestamp,"HH:mm DD.MM.YYYY").value),1),s("p",null,[t(pe,null,{default:n(()=>[h(p(e(N))+": ",1)]),_:1}),h(" "+p(e(B).responseComment),1)])])):_("",!0)]),t(ws,{"enter-active-class":"transition-all","leave-active-class":"transition-all","enter-from-class":"translate-y-[-30px] opacity-0","leave-to-class":"translate-y-[-30px] opacity-0"},{default:n(()=>[e(oe)?(o(),u("div",ct,[s("form",{class:"space-y-3",onSubmit:ue(r,["prevent"])},[t(ae,{modelValue:e(J),"onUpdate:modelValue":f[1]||(f[1]=w=>X(J)?J.value=w:null),class:L({"border-destructive focus-visible:ring-destructive":e(S)}),placeholder:"your respond..."},null,8,["modelValue","class"]),e(S)?(o(),u("p",it," response must have at least 5 characters ")):_("",!0),t(E,{class:"w-full mt-3"},{default:n(()=>[h(" response ")]),_:1})],32)])):_("",!0)]),_:1})])):(o(),u("form",{key:1,class:"flex flex-col items-center justify-center gap-3 mt-6",onSubmit:ue(G,["prevent"])},[s("div",ut,[s("ul",dt,[(o(),u(M,null,ie(5,w=>s("li",{key:w,class:"cursor-pointer",onClick:ye=>k(w)},[t(e(Pe),{class:L({"fill-primary":w<=e(P),"text-destructive":e(Y)}),"stroke-width":"1.25"},null,8,["class"])],8,pt)),64))]),s("span",mt,p(e(P))+" / 5",1)]),s("div",_t,[t(ae,{modelValue:e(q),"onUpdate:modelValue":f[2]||(f[2]=w=>X(q)?q.value=w:null),class:L({"border-destructive focus-visible:ring-destructive":e(V)}),placeholder:"your review..."},null,8,["modelValue","class"]),e(Y)?(o(),u("p",ft," rating must be from 1 to 5 stars ")):_("",!0),e(V)?(o(),u("p",vt," comment must have at least 5 characters ")):_("",!0),t(E,{type:"submit",class:"w-full"},{default:n(()=>[h(" submit ")]),_:1})])],32))])}}}),yt=H({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(y,{emit:c}){const O=Le(y,c);return(g,x)=>(o(),$(e(xs),gs(bs(e(O))),{default:n(()=>[te(g.$slots,"default")]),_:3},16))}}),wt=H({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(y,{emit:c}){const m=y,O=Le(m,c);return(g,x)=>(o(),$(e(Cs),null,{default:n(()=>[t(e(ks),de({class:[e(he)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",m.class)]},e(O)),{default:n(()=>[te(g.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),gt=H({__name:"DropdownMenuSeparator",props:{asChild:{type:Boolean},as:{}},setup(y){const c=y;return(m,D)=>(o(),$(e($s),de(c,{class:"-mx-1 my-1 h-px bg-muted"}),null,16))}}),bt=H({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},inset:{type:Boolean},class:{}},setup(y){const c=y;return(m,D)=>(o(),$(e(Is),de(c,{class:[e(he)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",m.inset&&"pl-8",c.class)]}),{default:n(()=>[te(m.$slots,"default")]),_:3},16,["class"]))}}),xt=H({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(y){const c=y;return(m,D)=>(o(),$(e(Ds),de({class:"outline-none"},c),{default:n(()=>[te(m.$slots,"default")]),_:3},16))}}),kt=H({__name:"Separator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(y){const c=y;return(m,D)=>(o(),$(e(Rs),{class:L([e(he)("shrink-0 bg-secondary",c.class),c.orientation==="vertical"?"w-px h-full":"h-px w-full"])},null,8,["class"]))}}),Ct={class:"py-10"},$t={class:"grid grid-cols-3 gap-5"},It={key:1,class:"relative my-6"},Dt=s("span",{class:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 bg-background"}," to you ",-1),Rt={key:0,class:"space-y-3"},Mt=["onClick"],Bt={class:"space-y-1"},St={class:"flex items-center justify-between w-"},At={class:"font-medium"},qt={class:"font-normal mr-1"},Vt={class:"space-x-1"},zt={class:"text-muted-foreground"},Et={key:1,class:"relative my-6"},Ut=s("span",{class:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 bg-background"},"from you",-1),Ft={key:2,class:"space-y-3"},jt=["onClick"],Nt={class:"space-y-1"},Tt={class:"flex items-center justify-between w-"},Ht={class:"font-medium"},Ot={class:"font-normal mr-1"},Pt={class:"space-x-1"},Yt={class:"text-muted-foreground"},Jt={key:3,class:"pt-6 text-center"},Kt=s("p",{class:"text-muted-foreground"}," there is no chat ",-1),Lt=[Kt],Wt={class:"col-span-2 flex flex-col border rounded-md"},Xt={class:"border-b flex items-center gap-3 p-3"},Gt={class:"space-x-2"},Qt={class:"font-medium"},Zt={class:"text-muted-foreground"},eo={class:"space-x-2"},so={class:"font-medium"},to={class:"text-muted-foreground"},oo={class:"ml-auto"},ao={class:"gap-2 flex items-center"},no=s("span",{class:"text-base"},"accept",-1),ro={class:"gap-2 flex items-center"},lo=s("span",{class:"text-base"},"decline",-1),co={class:"gap-2 flex items-center"},io=s("span",{class:"text-base"},"committee",-1),uo={key:0,class:"h-full flex-center"},po={class:"flex flex-col gap-2 h-full"},mo={key:0,class:"text-sm text-center text-muted-foreground"},_o={class:"text-sm text-muted-foreground text-end pr-3 py-1"},fo={key:3,class:"text-sm text-center text-muted-foreground"},vo={key:4,class:"text-sm text-center text-muted-foreground"},ho={class:"mt-auto p-3"},yo={class:"grow"},wo=s("span",null,"amount",-1),go={key:0,class:"text-destructive"},Do=H({__name:"chats",async setup(y){let c,m;const D=zs(),O=Es(),g=Je(),x=([c,m]=fe(()=>g.getEscrowFactory()),c=await c,m(),c),P=([c,m]=fe(()=>g.getChatFactory()),c=await c,m(),c),q=([c,m]=fe(()=>g.getCommitteeFactory()),c=await c,m(),c),{toast:Y}=Ms(),V=v(""),G=Bs(V,500),B=me([]),J=be(()=>G.value?B.value.filter(({buyerUsername:l,sellerUsername:a,job:{description:b,title:I}})=>JSON.stringify({buyerUsername:l,sellerUsername:a,title:I,description:b}).includes(G.value)):B.value),S=me([]),oe=be(()=>G.value?S.value.filter(({buyerUsername:l,sellerUsername:a,job:{description:b,title:I}})=>JSON.stringify({buyerUsername:l,sellerUsername:a,title:I,description:b}).includes(G.value)):S.value),r=v(),k=v(),z=be(()=>{var l,a;return!B.value.length&&!S.value.length||((l=r.value)==null?void 0:l.buyer)===j||((a=r.value)==null?void 0:a.seller)===j}),N=me([]),K=v("buyer"),d=me();async function f(){const l=[],a=[];for(const I of g.user.escrowIds){const C=await As(I);if(!C)return;const T=await ve(C.buyer),R=await ve(C.seller),le=await qs(C.jobId),Z={...C,buyerUsername:T.userName,sellerUsername:R.userName,job:le};_e(T.owner,g.address)?l.push(Z):a.push(Z)}B.value=l,S.value=a;const b=O.query.id;if(b){const I=Number.parseInt(b.toString()),C=l.find(R=>R.escrowId===I);if(C){await E(C);return}const T=a.find(R=>R.escrowId===I);if(T){await E(T);return}}l.length?await E(l[0]):a.length&&await E(a[0])}Ke(f);async function E(l){var b;if(((b=r.value)==null?void 0:b.escrowId)===l.escrowId)return;N.value=[],D.push(`/chats?id=${l.escrowId}`),K.value=l.buyerUsername===g.user.userName?"buyer":"seller",r.value=l,k.value=await Ne(l.escrowId),N.value=await Te(l.escrowId);const a=await He(l.escrowId);d.value={...a,username:_e(l.buyer,a.requester)?l.buyerUsername:l.sellerUsername}}async function pe(){if(!r.value)return;const a=await(await x.sendRequest(r.value.escrowId,{value:BigInt(r.value.price)})).wait();if((a==null?void 0:a.status)===1){if(!k.value)return;k.value.status=F.Pending}}async function ae(l){if(!r.value)return;const b=await(await x.respondToRequest(r.value.escrowId,l)).wait();if((b==null?void 0:b.status)===1){if(!k.value)return;k.value.status=l?F.Accepted:F.Declined}}const w=v("");async function ye(){if(!r.value||!w.value)return;const a=await(await P.sendMessage(r.value.escrowId,w.value)).wait();(a==null?void 0:a.status)===1&&(N.value=await Te(r.value.escrowId),w.value="")}const ne=v(!1),re=v(0),Q=v(""),we=v(!1);function Xe(){r.value&&(ne.value=!0,re.value=xe(r.value.price))}async function Ge(){if(!r.value)return;if(we.value=!1,Q.value.length<5){we.value=!0;return}const a=await(await q.openCommitteeReview(r.value.escrowId,Us(re.value),Q.value)).wait();(a==null?void 0:a.status)===1&&(k.value=await Ne(r.value.escrowId),ne.value=!1,Q.value="",Y({title:"step 1/2",description:"a committee is opening"}));const b=await He(r.value.escrowId),I=await q.getAllAvailableCommitteeMembers(),C=new Set;for(;C.size<b.requiredCommitteeMembers;){const le=Math.floor(Math.random()*I.length);C.add(I[le])}const R=await(await q.setCommitteeMembers(r.value.escrowId,Array.from(C))).wait();(R==null?void 0:R.status)===1&&Y({title:"step 2/2",description:"committee is setup for you",action:Fs(Hs,{altText:"to committee",onClick(){r.value&&D.push(`/committees/${r.value.escrowId}`)}},{default:()=>"to committee"})})}return(l,a)=>{var Ie,De,Re,Me,Be,Se,Ae,qe,Ve,ze;const b=_s,I=kt,C=js,T=Ts,R=Vs,le=xt,Z=bt,Ce=gt,Qe=wt,Ze=yt,ge=We,ee=Ns,es=ht,$e=Ye,ss=us,ts=ds,os=ps,as=vs,ns=fs,rs=ms,ls=is;return o(),u(M,null,[s("div",Ct,[s("div",$t,[s("div",{class:L(["col-span-1",e(z)?"border rounded-md":"border-none"])},[e(z)?_("",!0):(o(),$(b,{key:0,modelValue:e(V),"onUpdate:modelValue":a[0]||(a[0]=i=>X(V)?V.value=i:null),placeholder:"search for chats"},null,8,["modelValue"])),e(z)?_("",!0):(o(),u("div",It,[t(I),Dt])),t(T,{class:"h-[600px]"},{default:n(()=>[e(B).length?(o(),u("ul",Rt,[(o(!0),u(M,null,ie(e(J),i=>{var A;return o(),u("li",{key:i.escrowId,class:"cursor-pointer",onClick:se=>E(i)},[s("div",{class:L(["border rounded-md px-4 py-3 hover:border-primary transition-colors",{"border-primary":i.escrowId===((A=e(r))==null?void 0:A.escrowId)}])},[s("div",Bt,[s("div",St,[s("p",At," #"+p(i.jobId)+" "+p(i.job.title),1),t(C,null,{parent:n(()=>[s("span",qt,p(("toETH"in l?l.toETH:e(xe))(i.job.price)),1)]),_:2},1024)]),s("div",Vt,[s("span",null,p(i.sellerUsername),1),s("span",zt,p(e(Oe)(i.seller)),1)])])],2)],8,Mt)}),128))])):_("",!0),e(z)?_("",!0):(o(),u("div",Et,[t(I),Ut])),e(S).length?(o(),u("ul",Ft,[(o(!0),u(M,null,ie(e(oe),i=>{var A;return o(),u("li",{key:i.escrowId,class:"cursor-pointer",onClick:se=>E(i)},[s("div",{class:L(["border rounded-md px-4 py-3 hover:border-primary transition-colors",{"border-primary":i.escrowId===((A=e(r))==null?void 0:A.escrowId)}])},[s("div",Nt,[s("div",Tt,[s("p",Ht," #"+p(i.jobId)+" "+p(i.job.title),1),t(C,null,{parent:n(()=>[s("span",Ot,p(("toETH"in l?l.toETH:e(xe))(i.job.price)),1)]),_:2},1024)]),s("div",Pt,[s("span",null,p(i.buyerUsername),1),s("span",Yt,p(e(Oe)(i.buyer)),1)])])],2)],8,jt)}),128))])):_("",!0),e(z)?(o(),u("div",Jt,Lt)):_("",!0)]),_:1})],2),s("div",Wt,[s("div",Xt,[e(K)==="buyer"?(o(),u(M,{key:0},[t(R,{address:(Ie=e(r))==null?void 0:Ie.seller,size:35},null,8,["address"]),s("div",Gt,[s("span",Qt,p(((De=e(r))==null?void 0:De.sellerUsername)??"n.a."),1),s("span",Zt,p(((Re=e(r))==null?void 0:Re.seller)??e(j)),1)])],64)):(o(),u(M,{key:1},[t(R,{address:(Me=e(r))==null?void 0:Me.buyer,size:35},null,8,["address"]),s("div",eo,[s("span",so,p(((Be=e(r))==null?void 0:Be.buyerUsername)??"n.a."),1),s("span",to,p(((Se=e(r))==null?void 0:Se.buyer)??e(j)),1)])],64)),s("div",oo,[((Ae=e(k))==null?void 0:Ae.status)===e(F).Pending&&!e(_e)(((qe=e(d))==null?void 0:qe.requester)??"",e(g).address)?(o(),$(Ze,{key:0},{default:n(()=>[t(le,null,{default:n(()=>[t(e(ce),{variant:"outline",size:"icon",class:"h-8 w-8"},{default:n(()=>[t(e(Ks),{size:20})]),_:1})]),_:1}),t(Qe,{align:"end"},{default:n(()=>{var i,A;return[e(K)==="seller"?(o(),u(M,{key:0},[t(Z,{class:"text-highlight pr-4",onClick:a[1]||(a[1]=se=>ae(!0))},{default:n(()=>[s("div",ao,[t(e(Os),{size:24}),no])]),_:1}),t(Ce),t(Z,{class:"text-destructive pr-4",onClick:a[2]||(a[2]=se=>ae(!1))},{default:n(()=>[s("div",ro,[t(e(Ws),{size:24}),lo])]),_:1}),(i=e(d))!=null&&i.isClosed?_("",!0):(o(),$(Ce,{key:0}))],64)):_("",!0),(A=e(d))!=null&&A.isClosed?_("",!0):(o(),$(Z,{key:1,class:"text-yellow-500 dark:text-yellow-400 pr-4",onClick:Xe},{default:n(()=>[s("div",co,[t(e(Ys),{size:24}),io])]),_:1}))]}),_:1})]),_:1})):_("",!0)])]),e(z)?(o(),u("div",uo,[t(e(Js),{size:100,"stroke-width":"0.75",class:"text-muted-foreground"})])):(o(),$(T,{key:1,class:"grow p-3"},{default:n(()=>{var i,A,se,Ee,Ue;return[s("div",po,[((i=e(k))==null?void 0:i.status)===e(F).Pending&&e(N).length===0?(o(),u("p",mo," you both are now connected ")):_("",!0),((A=e(k))==null?void 0:A.status)===e(F).Start?(o(),u(M,{key:1},[e(K)==="buyer"?(o(),u(M,{key:0},[t(ee,null,{default:n(()=>[t(ge,null,{default:n(()=>{var U;return[h(p(((U=e(r))==null?void 0:U.sellerUsername)??"n.a."),1)]}),_:1}),h(" hat accepted your job buy request! ")]),_:1}),t(ee,null,{default:n(()=>[h(" click this button to connect with them. ")]),_:1}),t(ee,{"parent-class":""},{default:n(()=>[t(e(ce),{size:"sm",onClick:pe},{default:n(()=>[h(" connect ")]),_:1})]),_:1})],64)):(o(),u(M,{key:1},[t(ee,{dir:"right"},{default:n(()=>[h(" you hat already sent job request to "),t(ge,null,{default:n(()=>{var U;return[h(p(((U=e(r))==null?void 0:U.buyerUsername)??"n.a."),1)]}),_:1}),h(". ")]),_:1}),t(ee,{dir:"right"},{default:n(()=>[h(" wait for them to accept! ")]),_:1})],64))],64)):_("",!0),(o(!0),u(M,null,ie(e(N),({sender:U,timestamp:Fe,content:cs})=>(o(),$(ee,{key:Fe,dir:e(_e)(U,e(g).address)?"right":"left"},{timestamp:n(()=>[s("p",_o,p(("useDateFormat"in l?l.useDateFormat:e(ke))(Fe,"HH:mm DD.MM.YY").value),1)]),default:n(()=>[h(p(cs)+" ",1)]),_:2},1032,["dir"]))),128)),((se=e(k))==null?void 0:se.status)===e(F).Accepted&&e(r)?(o(),$(es,{key:2,"escrow-id":e(r).escrowId},null,8,["escrow-id"])):_("",!0),((Ee=e(k))==null?void 0:Ee.status)===e(F).Declined?(o(),u("p",fo," escrow has been canceled. ")):_("",!0),e(r)&&((Ue=e(d))==null?void 0:Ue.requester)!==e(j)?(o(),u("p",vo,[h(" a committee has been requested by "),t(ge,null,{default:n(()=>{var U;return[h(p((U=e(d))==null?void 0:U.username),1)]}),_:1})])):_("",!0)])]}),_:1})),s("div",ho,[s("form",{class:"flex items-center gap-3",onSubmit:ue(ye,["prevent"])},[s("div",yo,[t($e,{modelValue:e(w),"onUpdate:modelValue":a[3]||(a[3]=i=>X(w)?w.value=i:null),class:"min-h-0",placeholder:"type something here...",onKeyup:Ss(ue(ye,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"])]),t(e(ce),{size:"icon",disabled:e(z)||((Ve=e(k))==null?void 0:Ve.status)===e(F).Accepted||((ze=e(k))==null?void 0:ze.status)===e(F).Declined},{default:n(()=>[t(e(Ps),{size:20})]),_:1},8,["disabled"])],32)])])])]),t(ls,{open:e(ne),"onUpdate:open":a[6]||(a[6]=i=>X(ne)?ne.value=i:null)},{default:n(()=>[t(rs,{class:"sm:max-w-[425px]"},{default:n(()=>[t(os,null,{default:n(()=>[t(ss,null,{default:n(()=>[h("request committee")]),_:1}),t(ts)]),_:1}),s("form",{class:"space-y-3",onSubmit:ue(Ge,["prevent"])},[t(ns,{class:"flex items-center gap-3"},{default:n(()=>[wo,t(as,{modelValue:e(re),"onUpdate:modelValue":a[4]||(a[4]=i=>X(re)?re.value=i:null),min:"0",type:"number"},null,8,["modelValue"])]),_:1}),t($e,{modelValue:e(Q),"onUpdate:modelValue":a[5]||(a[5]=i=>X(Q)?Q.value=i:null),placeholder:"reason why you want to open a committee"},null,8,["modelValue"]),e(we)?(o(),u("p",go," reason should have more than 5 characters ")):_("",!0),t(e(ce),{class:"w-full",type:"submit"},{default:n(()=>[h(" request ")]),_:1})],32)]),_:1})]),_:1},8,["open"])],64)}}});export{Do as default};
