import{_ as Pe,e as is,a as us,b as ds,c as ps,d as ms}from"./DialogTitle.vue_vue_type_script_setup_true_lang-jYUKdDdw.js";import{a as _s,_ as fs}from"./BaseSearch.vue_vue_type_script_setup_true_lang-3QHJgIT6.js";import{_ as vs}from"./Input.vue_vue_type_script_setup_true_lang-1cfV215H.js";import{c as X,O as hs,o,j as c,r as le,d as Q,t as Ye,v as me,z as v,y as je,aa as U,a8 as Je,u as e,D as s,F as R,E as ne,f as t,k as L,C as p,ab as xe,a as M,w as n,J as f,B as h,K as re,I as W,ac as ys,L as _e,N as Ke,T as Le,P as ws,Q as gs,ad as bs,ae as xs,h as ke,m as fe,af as ks,ag as Cs,ah as $s,ai as Is,aj as Ds,ak as Rs,a7 as Ms,x as de,a5 as ge,al as Bs,am as Ss,an as As,H as pe,ao as qs,ap as Ne,aq as Te,ar as Vs,as as Fs,at as zs,G as be,au as He,av as E,S as Es,_ as Us}from"./index-ORWt1aT8.js";import{_ as js}from"./ChatBox.vue_vue_type_script_setup_true_lang-JvR8RJHz.js";import{_ as Ns}from"./ScrollArea.vue_vue_type_script_setup_true_lang-jbtXQxzy.js";/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=X("CheckCircle2Icon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=X("ForwardIcon",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=X("HelpCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=X("MessageCircleOffIcon",[["path",{d:"M20.5 14.9A9 9 0 0 0 9.1 3.5",key:"1iebmn"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.6 5.6C3 8.3 2.2 12.5 4 16l-2 6 6-2c3.4 1.8 7.6 1.1 10.3-1.7",key:"1ov8ce"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=X("MoreVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=X("ReplyIcon",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=X("StarIcon",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=X("XCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ls={},Xs={class:"text-highlight italic"};function Qs(b,i){return o(),c("span",Xs,[le(b.$slots,"default")])}const Xe=hs(Ls,[["render",Qs]]),Ws={class:"py-3"},Gs=s("p",{class:"text-sm text-center text-muted-foreground"}," this channel is closed ",-1),Zs={key:0},et={class:"border px-4 py-3 rounded-md mt-6 space-y-3 w-4/5 mx-auto"},st={class:"flex items-center gap-3 min-h-10"},tt={class:"flex items-center gap-1"},ot={class:"text-muted-foreground"},at={key:0,class:"bg-secondary p-3 rounded-md space-y-1"},nt={class:"text-muted-foreground"},rt={key:0,class:"border px-4 py-3 rounded-md w-4/5 mx-auto mt-3"},lt={key:0,class:"text-destructive"},ct={class:"flex items-center gap-3"},it={class:"flex items-center gap-1"},ut=["onClick"],dt={class:"mt-1"},pt={class:"w-1/2 space-y-3"},mt={key:0,class:"text-destructive"},_t={key:1,class:"text-destructive"},ft=Q({__name:"ChatReview",props:{escrowId:{}},async setup(b){let i,_;const S=b,T=Ye(),w=([i,_]=me(()=>T.getReviewFactory()),i=await i,_(),i),x=v(),H=v(0),A=v(""),O=v(!1),q=v(!1);je(A,d=>{d.length>=5&&(q.value=!1)});async function G(){if(O.value=!1,q.value=!1,H.value<1||H.value>5){O.value=!0;return}if(A.value.length<5){q.value=!0;return}const m=await(await w.createReview(S.escrowId,H.value,A.value)).wait();(m==null?void 0:m.status)===1&&await Y()}const I=v(),P=v(""),V=v(!1),se=v(!1);je(P,d=>{d.length>=5&&(V.value=!1)});async function l(){if(!x.value)return;if(V.value=!1,P.value.length<5){V.value=!0;return}const m=await(await w.createResponse(x.value.id,P.value)).wait();(m==null?void 0:m.status)===1&&await Y()}function C(d){H.value=d,O.value=!1}const F=v(U),j=v(U);async function Y(){try{const d=await w.getReviewByEscrowId(S.escrowId);if(d[2]===U||d[3]===U)return;x.value={timestamp:Number(d[0]),rating:Number(d[1]),reviewingAddress:d[2],beingReviewedAddress:d[3],reviewComment:d[4],relevantEscrowId:Number(d[5]),responded:d[6],id:Number(d[7])},F.value=(await _e(x.value.reviewingAddress)).userName,j.value=(await _e(x.value.beingReviewedAddress)).userName;const m=await w.getResponse(x.value.id);if(m[1]===U)return;I.value={timestamp:Number(m[0]),responder:m[1],responseComment:m[2]}}catch{}}return Je(Y),(d,m)=>{const B=Ke,ce=Xe,te=Pe;return o(),c("div",Ws,[Gs,e(x)?(o(),c("div",Zs,[s("div",et,[s("div",st,[s("ul",tt,[(o(),c(R,null,ne(5,y=>s("li",{key:y},[t(e(Oe),{class:L({"fill-primary":y<=e(x).rating}),"stroke-width":"1.25"},null,8,["class"])])),64))]),s("p",ot,p(("useDateFormat"in d?d.useDateFormat:e(xe))(e(x).timestamp,"HH:mm DD.MM.YYYY").value),1),e(j)===e(T).user.userName&&!e(I)?(o(),M(B,{key:0,size:"icon",class:"ml-auto",variant:"ghost",onClick:m[0]||(m[0]=y=>se.value=!e(se))},{default:n(()=>[t(e(Js))]),_:1})):f("",!0)]),s("p",null,[t(ce,null,{default:n(()=>[h(p(e(F))+": ",1)]),_:1}),h(" "+p(e(x).reviewComment),1)]),e(I)?(o(),c("div",at,[s("p",nt,p(("useDateFormat"in d?d.useDateFormat:e(xe))(e(I).timestamp,"HH:mm DD.MM.YYYY").value),1),s("p",null,[t(ce,null,{default:n(()=>[h(p(e(j))+": ",1)]),_:1}),h(" "+p(e(I).responseComment),1)])])):f("",!0)]),t(ys,{"enter-active-class":"transition-all","leave-active-class":"transition-all","enter-from-class":"translate-y-[-30px] opacity-0","leave-to-class":"translate-y-[-30px] opacity-0"},{default:n(()=>[e(se)?(o(),c("div",rt,[s("form",{class:"space-y-3",onSubmit:re(l,["prevent"])},[t(te,{modelValue:e(P),"onUpdate:modelValue":m[1]||(m[1]=y=>W(P)?P.value=y:null),class:L({"border-destructive focus-visible:ring-destructive":e(V)}),placeholder:"your respond..."},null,8,["modelValue","class"]),e(V)?(o(),c("p",lt," response must have at least 5 characters ")):f("",!0),t(B,{class:"w-full mt-3"},{default:n(()=>[h(" response ")]),_:1})],32)])):f("",!0)]),_:1})])):(o(),c("form",{key:1,class:"flex flex-col items-center justify-center gap-3 mt-6",onSubmit:re(G,["prevent"])},[s("div",ct,[s("ul",it,[(o(),c(R,null,ne(5,y=>s("li",{key:y,class:"cursor-pointer",onClick:ve=>C(y)},[t(e(Oe),{class:L({"fill-primary":y<=e(H),"text-destructive":e(O)}),"stroke-width":"1.25"},null,8,["class"])],8,ut)),64))]),s("span",dt,p(e(H))+" / 5",1)]),s("div",pt,[t(te,{modelValue:e(A),"onUpdate:modelValue":m[2]||(m[2]=y=>W(A)?A.value=y:null),class:L({"border-destructive focus-visible:ring-destructive":e(q)}),placeholder:"your review..."},null,8,["modelValue","class"]),e(O)?(o(),c("p",mt," rating must be from 1 to 5 stars ")):f("",!0),e(q)?(o(),c("p",_t," comment must have at least 5 characters ")):f("",!0),t(B,{type:"submit",class:"w-full"},{default:n(()=>[h(" submit ")]),_:1})])],32))])}}}),vt=Q({__name:"DropdownMenu",props:{open:{type:Boolean},defaultOpen:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(b,{emit:i}){const T=Le(b,i);return(w,x)=>(o(),M(e(bs),ws(gs(e(T))),{default:n(()=>[le(w.$slots,"default")]),_:3},16))}}),ht=Q({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss","entryFocus","openAutoFocus","closeAutoFocus"],setup(b,{emit:i}){const _=b,T=Le(_,i);return(w,x)=>(o(),M(e(ks),null,{default:n(()=>[t(e(xs),fe({class:[e(ke)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",_.class)]},e(T)),{default:n(()=>[le(w.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),yt=Q({__name:"DropdownMenuSeparator",props:{asChild:{type:Boolean},as:{}},setup(b){const i=b;return(_,S)=>(o(),M(e(Cs),fe(i,{class:"-mx-1 my-1 h-px bg-muted"}),null,16))}}),wt=Q({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},inset:{type:Boolean},class:{}},setup(b){const i=b;return(_,S)=>(o(),M(e($s),fe(i,{class:[e(ke)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",_.inset&&"pl-8",i.class)]}),{default:n(()=>[le(_.$slots,"default")]),_:3},16,["class"]))}}),gt=Q({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(b){const i=b;return(_,S)=>(o(),M(e(Is),fe({class:"outline-none"},i),{default:n(()=>[le(_.$slots,"default")]),_:3},16))}}),bt=Q({__name:"Separator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(b){const i=b;return(_,S)=>(o(),M(e(Ds),{class:L([e(ke)("shrink-0 bg-secondary",i.class),i.orientation==="vertical"?"w-px h-full":"h-px w-full"])},null,8,["class"]))}}),xt={class:"py-10"},kt={class:"grid grid-cols-3 gap-5"},Ct={key:1,class:"relative my-6"},$t=s("span",{class:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 bg-background"}," to you ",-1),It={key:0,class:"space-y-3"},Dt=["onClick"],Rt={class:"space-y-1"},Mt={class:"flex items-center justify-between w-"},Bt={class:"font-medium"},St={class:"font-normal mr-1"},At={class:"space-x-1"},qt={class:"text-muted-foreground"},Vt={key:1,class:"relative my-6"},Ft=s("span",{class:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 bg-background"},"from you",-1),zt={key:2,class:"space-y-3"},Et=["onClick"],Ut={class:"space-y-1"},jt={class:"flex items-center justify-between w-"},Nt={class:"font-medium"},Tt={class:"font-normal mr-1"},Ht={class:"space-x-1"},Ot={class:"text-muted-foreground"},Pt={key:3,class:"pt-6 text-center"},Yt=s("p",{class:"text-muted-foreground"}," there is no chat ",-1),Jt=[Yt],Kt={class:"col-span-2 flex flex-col border rounded-md"},Lt={class:"border-b flex items-center gap-3 p-3"},Xt={class:"space-x-2"},Qt={class:"font-medium"},Wt={class:"text-muted-foreground"},Gt={class:"space-x-2"},Zt={class:"font-medium"},eo={class:"text-muted-foreground"},so={class:"ml-auto"},to={class:"gap-2 flex items-center"},oo=s("span",{class:"text-base"},"accept",-1),ao={class:"gap-2 flex items-center"},no=s("span",{class:"text-base"},"decline",-1),ro={class:"gap-2 flex items-center"},lo=s("span",{class:"text-base"},"committee",-1),co={key:0,class:"h-full flex-center"},io={class:"flex flex-col gap-2 h-full"},uo={key:0,class:"text-sm text-center text-muted-foreground"},po={class:"text-sm text-muted-foreground text-end pr-3 py-1"},mo={key:3,class:"text-sm text-center text-muted-foreground"},_o={key:4,class:"text-sm text-center text-muted-foreground"},fo={class:"mt-auto p-3"},vo={class:"grow"},ho=s("span",null,"amount",-1),yo={key:0,class:"text-destructive"},$o=Q({__name:"chats",async setup(b){let i,_;const S=Fs(),T=zs(),w=Ye(),x=([i,_]=me(()=>w.getEscrowFactory()),i=await i,_(),i),H=([i,_]=me(()=>w.getChatFactory()),i=await i,_(),i),A=([i,_]=me(()=>w.getCommitteeFactory()),i=await i,_(),i),{toast:O}=Rs(),q=v(""),G=Ms(q,500),I=de([]),P=ge(()=>G.value?I.value.filter(({buyerUsername:r,sellerUsername:a,job:{description:g,title:$}})=>JSON.stringify({buyerUsername:r,sellerUsername:a,title:$,description:g}).includes(G.value)):I.value),V=de([]),se=ge(()=>G.value?V.value.filter(({buyerUsername:r,sellerUsername:a,job:{description:g,title:$}})=>JSON.stringify({buyerUsername:r,sellerUsername:a,title:$,description:g}).includes(G.value)):I.value),l=v(),C=v(),F=ge(()=>{var r,a;return!I.value.length&&!V.value.length||((r=l.value)==null?void 0:r.buyer)===U||((a=l.value)==null?void 0:a.seller)===U}),j=de([]),Y=v("buyer"),d=de();async function m(){const r=[],a=[];for(const $ of w.user.escrowIds){const k=await Ss($);if(!k)return;const N=await _e(k.buyer),D=await _e(k.seller),J=await As(k.jobId),ie={...k,buyerUsername:N.userName,sellerUsername:D.userName,job:J};pe(N.owner,w.address)?r.push(ie):a.push(ie)}I.value=r,V.value=a;const g=T.query.id;if(g){const $=Number.parseInt(g.toString()),k=r.find(D=>D.escrowId===$);if(k){await B(k);return}const N=a.find(D=>D.escrowId===$);if(N){await B(N);return}}r.length?await B(r[0]):a.length&&await B(a[0])}Je(m);async function B(r){var g;if(((g=l.value)==null?void 0:g.escrowId)===r.escrowId)return;j.value=[],S.push(`/chats?id=${r.escrowId}`),Y.value=r.buyerUsername===w.user.userName?"buyer":"seller",l.value=r,C.value=await qs(r.escrowId),j.value=await Ne(r.escrowId);const a=await Te(r.escrowId);d.value={...a,username:pe(r.buyer,a.requester)?r.buyerUsername:r.sellerUsername}}async function ce(){if(!l.value)return;const a=await(await x.sendRequest(l.value.escrowId,{value:BigInt(l.value.price)})).wait();if((a==null?void 0:a.status)===1){if(!C.value)return;C.value.status=E.Pending}}async function te(r){if(!l.value)return;const g=await(await x.respondToRequest(l.value.escrowId,r)).wait();if((g==null?void 0:g.status)===1){if(!C.value)return;C.value.status=r?E.Accepted:E.Declined}}const y=v("");async function ve(){if(!l.value||!y.value)return;const a=await(await H.sendMessage(l.value.escrowId,y.value)).wait();(a==null?void 0:a.status)===1&&(j.value=await Ne(l.value.escrowId),y.value="")}const oe=v(!1),ae=v(0),Z=v(""),he=v(!1);function Qe(){l.value&&(oe.value=!0,ae.value=be(l.value.price))}async function We(){if(!l.value)return;if(he.value=!1,Z.value.length<5){he.value=!0;return}const a=await(await A.openCommitteeReview(l.value.escrowId,Es(ae.value),Z.value)).wait();(a==null?void 0:a.status)===1&&(B(l.value),oe.value=!1,Z.value="",O({title:"step 1/2",description:"a committee is opening"}));const g=await Te(l.value.escrowId),$=await A.getAllAvailableCommitteeMembers(),k=new Set;for(;k.size<g.requiredCommitteeMembers;){const J=Math.floor(Math.random()*$.length);k.add($[J])}const D=await(await A.setCommitteeMembers(l.value.escrowId,Array.from(k))).wait();(D==null?void 0:D.status)===1&&O({title:"step 2/2",description:"committee is setup for you"})}return(r,a)=>{var Ie,De,Re,Me,Be,Se,Ae,qe,Ve,Fe;const g=_s,$=bt,k=Us,N=Ns,D=Vs,J=Ke,ie=gt,ye=wt,Ce=yt,Ge=ht,Ze=vt,we=Xe,ee=js,es=ft,$e=Pe,ss=us,ts=ds,os=ps,as=vs,ns=fs,rs=ms,ls=is;return o(),c(R,null,[s("div",xt,[s("div",kt,[s("div",{class:L(["col-span-1",e(F)?"border rounded-md":"border-none"])},[e(F)?f("",!0):(o(),M(g,{key:0,modelValue:e(q),"onUpdate:modelValue":a[0]||(a[0]=u=>W(q)?q.value=u:null),placeholder:"search for chats"},null,8,["modelValue"])),e(F)?f("",!0):(o(),c("div",Ct,[t($),$t])),t(N,{class:"h-[600px]"},{default:n(()=>[e(I).length?(o(),c("ul",It,[(o(!0),c(R,null,ne(e(P),u=>{var K;return o(),c("li",{key:u.escrowId,class:"cursor-pointer",onClick:ue=>B(u)},[s("div",{class:L(["border rounded-md px-4 py-3 hover:border-primary transition-colors",{"border-primary":u.escrowId===((K=e(l))==null?void 0:K.escrowId)}])},[s("div",Rt,[s("div",Mt,[s("p",Bt," #"+p(u.jobId)+" "+p(u.job.title),1),t(k,null,{parent:n(()=>[s("span",St,p(("toETH"in r?r.toETH:e(be))(u.job.price)),1)]),_:2},1024)]),s("div",At,[s("span",null,p(u.sellerUsername),1),s("span",qt,p(e(He)(u.seller)),1)])])],2)],8,Dt)}),128))])):f("",!0),e(F)?f("",!0):(o(),c("div",Vt,[t($),Ft])),e(V).length?(o(),c("ul",zt,[(o(!0),c(R,null,ne(e(se),u=>{var K;return o(),c("li",{key:u.escrowId,class:"cursor-pointer",onClick:ue=>B(u)},[s("div",{class:L(["border rounded-md px-4 py-3 hover:border-primary transition-colors",{"border-primary":u.escrowId===((K=e(l))==null?void 0:K.escrowId)}])},[s("div",Ut,[s("div",jt,[s("p",Nt," #"+p(u.jobId)+" "+p(u.job.title),1),t(k,null,{parent:n(()=>[s("span",Tt,p(("toETH"in r?r.toETH:e(be))(u.job.price)),1)]),_:2},1024)]),s("div",Ht,[s("span",null,p(u.buyerUsername),1),s("span",Ot,p(e(He)(u.buyer)),1)])])],2)],8,Et)}),128))])):f("",!0),e(F)?(o(),c("div",Pt,Jt)):f("",!0)]),_:1})],2),s("div",Kt,[s("div",Lt,[e(Y)==="buyer"?(o(),c(R,{key:0},[t(D,{address:(Ie=e(l))==null?void 0:Ie.seller,size:35},null,8,["address"]),s("div",Xt,[s("span",Qt,p(((De=e(l))==null?void 0:De.sellerUsername)??"n.a."),1),s("span",Wt,p(((Re=e(l))==null?void 0:Re.seller)??e(U)),1)])],64)):(o(),c(R,{key:1},[t(D,{address:(Me=e(l))==null?void 0:Me.buyer,size:35},null,8,["address"]),s("div",Gt,[s("span",Zt,p(((Be=e(l))==null?void 0:Be.buyerUsername)??"n.a."),1),s("span",eo,p(((Se=e(l))==null?void 0:Se.buyer)??e(U)),1)])],64)),s("div",so,[((Ae=e(C))==null?void 0:Ae.status)===e(E).Pending&&!e(pe)(((qe=e(d))==null?void 0:qe.requester)??"",e(w).address)?(o(),M(Ze,{key:0},{default:n(()=>[t(ie,null,{default:n(()=>[t(J,{variant:"outline",size:"icon",class:"h-8 w-8"},{default:n(()=>[t(e(Ys),{size:20})]),_:1})]),_:1}),t(Ge,{align:"end"},{default:n(()=>[e(Y)==="seller"?(o(),c(R,{key:0},[t(ye,{class:"text-highlight pr-4",onClick:a[1]||(a[1]=u=>te(!0))},{default:n(()=>[s("div",to,[t(e(Ts),{size:24}),oo])]),_:1}),t(Ce),t(ye,{class:"text-destructive pr-4",onClick:a[2]||(a[2]=u=>te(!1))},{default:n(()=>[s("div",ao,[t(e(Ks),{size:24}),no])]),_:1}),t(Ce)],64)):f("",!0),t(ye,{class:"text-yellow-500 dark:text-yellow-400 pr-4",onClick:Qe},{default:n(()=>[s("div",ro,[t(e(Os),{size:24}),lo])]),_:1})]),_:1})]),_:1})):f("",!0)])]),e(F)?(o(),c("div",co,[t(e(Ps),{size:100,"stroke-width":"0.75",class:"text-muted-foreground"})])):(o(),M(N,{key:1,class:"grow p-3"},{default:n(()=>{var u,K,ue,ze,Ee;return[s("div",io,[((u=e(C))==null?void 0:u.status)===e(E).Pending&&e(j).length===0?(o(),c("p",uo," you both are now connected ")):f("",!0),((K=e(C))==null?void 0:K.status)===e(E).Start?(o(),c(R,{key:1},[e(Y)==="buyer"?(o(),c(R,{key:0},[t(ee,null,{default:n(()=>[t(we,null,{default:n(()=>{var z;return[h(p(((z=e(l))==null?void 0:z.sellerUsername)??"n.a."),1)]}),_:1}),h(" hat accepted your job buy request! ")]),_:1}),t(ee,null,{default:n(()=>[h(" click this button to connect with them. ")]),_:1}),t(ee,{"parent-class":""},{default:n(()=>[t(J,{size:"sm",onClick:ce},{default:n(()=>[h(" connect ")]),_:1})]),_:1})],64)):(o(),c(R,{key:1},[t(ee,{dir:"right"},{default:n(()=>[h(" you hat already sent job request to "),t(we,null,{default:n(()=>{var z;return[h(p(((z=e(l))==null?void 0:z.buyerUsername)??"n.a."),1)]}),_:1}),h(". ")]),_:1}),t(ee,{dir:"right"},{default:n(()=>[h(" wait for them to accept! ")]),_:1})],64))],64)):f("",!0),(o(!0),c(R,null,ne(e(j),({sender:z,timestamp:Ue,content:cs})=>(o(),M(ee,{key:Ue,dir:e(pe)(z,e(w).address)?"right":"left"},{timestamp:n(()=>[s("p",po,p(("useDateFormat"in r?r.useDateFormat:e(xe))(Ue,"HH:mm DD.MM.YY").value),1)]),default:n(()=>[h(p(cs)+" ",1)]),_:2},1032,["dir"]))),128)),((ue=e(C))==null?void 0:ue.status)===e(E).Accepted&&e(l)?(o(),M(es,{key:2,"escrow-id":e(l).escrowId},null,8,["escrow-id"])):f("",!0),((ze=e(C))==null?void 0:ze.status)===e(E).Declined?(o(),c("p",mo," escrow has been canceled. ")):f("",!0),e(l)&&((Ee=e(d))==null?void 0:Ee.requester)!==e(U)?(o(),c("p",_o,[h(" a committee has been requested by "),t(we,null,{default:n(()=>{var z;return[h(p((z=e(d))==null?void 0:z.username),1)]}),_:1})])):f("",!0)])]}),_:1})),s("div",fo,[s("form",{class:"flex items-center gap-3",onSubmit:re(ve,["prevent"])},[s("div",vo,[t($e,{modelValue:e(y),"onUpdate:modelValue":a[3]||(a[3]=u=>W(y)?y.value=u:null),class:"min-h-0",placeholder:"type something here...",onKeyup:Bs(re(ve,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"])]),t(J,{size:"icon",disabled:e(F)||((Ve=e(C))==null?void 0:Ve.status)===e(E).Accepted||((Fe=e(C))==null?void 0:Fe.status)===e(E).Declined},{default:n(()=>[t(e(Hs),{size:20})]),_:1},8,["disabled"])],32)])])])]),t(ls,{open:e(oe),"onUpdate:open":a[6]||(a[6]=u=>W(oe)?oe.value=u:null)},{default:n(()=>[t(rs,{class:"sm:max-w-[425px]"},{default:n(()=>[t(os,null,{default:n(()=>[t(ss,null,{default:n(()=>[h("request committee")]),_:1}),t(ts)]),_:1}),s("form",{class:"space-y-3",onSubmit:re(We,["prevent"])},[t(ns,{class:"flex items-center gap-3"},{default:n(()=>[ho,t(as,{modelValue:e(ae),"onUpdate:modelValue":a[4]||(a[4]=u=>W(ae)?ae.value=u:null),min:"0",type:"number"},null,8,["modelValue"])]),_:1}),t($e,{modelValue:e(Z),"onUpdate:modelValue":a[5]||(a[5]=u=>W(Z)?Z.value=u:null),placeholder:"reason why you want to open a committee"},null,8,["modelValue"]),e(he)?(o(),c("p",yo," reason should have more than 5 characters ")):f("",!0),t(J,{class:"w-full",type:"submit"},{default:n(()=>[h(" request ")]),_:1})],32)]),_:1})]),_:1},8,["open"])],64)}}});export{$o as default};
